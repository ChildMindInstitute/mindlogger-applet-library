{"version":3,"sources":["../../src/ts/filter/floating/provided/textInputFloatingFilter.ts"],"names":[],"mappings":"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","file":"textInputFloatingFilter.js","sourcesContent":["import { IFloatingFilterParams } from \"../floatingFilter\";\nimport { RefSelector } from \"../../../widgets/componentAnnotations\";\nimport { ProvidedFilterModel } from \"../../../interfaces/iFilter\";\nimport { _ } from \"../../../utils\";\nimport { Constants } from \"../../../constants\";\nimport { ProvidedFilter } from \"../../provided/providedFilter\";\nimport { PostConstruct } from \"../../../context/context\";\nimport { SimpleFloatingFilter } from \"./simpleFloatingFilter\";\nimport { ISimpleFilterModel, SimpleFilter } from \"../../provided/simpleFilter\";\nimport { FilterChangedEvent } from \"../../../events\";\n\nexport abstract class TextInputFloatingFilter extends SimpleFloatingFilter {\n\n    @RefSelector('eFloatingFilterText')\n    private eFloatingFilterText: HTMLInputElement;\n\n    protected params: IFloatingFilterParams;\n\n    private applyActive: boolean;\n\n    @PostConstruct\n    private postConstruct(): void {\n        this.setTemplate(\n            `<div class=\"ag-input-wrapper\" role=\"presentation\">\n                <input ref=\"eFloatingFilterText\" class=\"ag-floating-filter-input\">\n            </div>`);\n    }\n\n    protected getDefaultDebounceMs(): number {\n        return 500;\n    }\n\n    public onParentModelChanged(model: ProvidedFilterModel, event: FilterChangedEvent): void {\n        // we don't want to update the floating filter if the floating filter caused the change.\n        // as if it caused the change, the ui is already in sycn. if we didn't do this, the UI\n        // would behave strange as it would be updating as the user is typing\n        if (this.isEventFromFloatingFilter(event)) { return; }\n\n        this.setLastTypeFromModel(model);\n        const modelString = this.getTextFromModel(model);\n        this.eFloatingFilterText.value = modelString;\n        const editable = this.canWeEditAfterModelFromParentFilter(model);\n        this.setEditable(editable);\n    }\n\n    public init(params: IFloatingFilterParams): void {\n        super.init(params);\n        this.params = params;\n\n        this.applyActive = ProvidedFilter.isUseApplyButton(this.params.filterParams);\n        const debounceMs = ProvidedFilter.getDebounceMs(this.params.filterParams, this.getDefaultDebounceMs());\n\n        const toDebounce: () => void = _.debounce(this.syncUpWithParentFilter.bind(this), debounceMs);\n\n        this.addDestroyableEventListener(this.eFloatingFilterText, 'input', toDebounce);\n        this.addDestroyableEventListener(this.eFloatingFilterText, 'keypress', toDebounce);\n        this.addDestroyableEventListener(this.eFloatingFilterText, 'keydown', toDebounce);\n\n        const columnDef = (params.column.getDefinition() as any);\n        if (columnDef.filterParams && columnDef.filterParams.filterOptions && columnDef.filterParams.filterOptions.length === 1 && columnDef.filterParams.filterOptions[0] === 'inRange') {\n            this.eFloatingFilterText.disabled = true;\n        }\n    }\n\n    private syncUpWithParentFilter(e: KeyboardEvent): void {\n        const value = this.eFloatingFilterText.value;\n\n        const enterKeyPressed = _.isKeyPressed(e, Constants.KEY_ENTER);\n        if (this.applyActive && !enterKeyPressed) { return; }\n\n        this.params.parentFilterInstance(filterInstance => {\n            if (filterInstance) {\n                const simpleFilter = filterInstance as SimpleFilter<ISimpleFilterModel>;\n                simpleFilter.onFloatingFilterChanged(this.getLastType(), value);\n            }\n        });\n    }\n\n    protected setEditable(editable: boolean): void {\n        this.eFloatingFilterText.disabled = !editable;\n    }\n}\n"]}