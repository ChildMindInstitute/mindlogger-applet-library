{"version":3,"sources":["../../src/ts/environment.ts"],"names":[],"mappings":"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","file":"environment.js","sourcesContent":["import { Bean, Autowired } from './context/context';\nimport { _ } from './utils';\n\nconst MAT_GRID_SIZE = 8;\n\nexport type SASS_PROPERTIES = 'headerHeight' | 'virtualItemHeight' | 'rowHeight' | 'chartMenuPanelWidth';\ninterface HardCodedSize {\n    [key: string]: {\n        [key in SASS_PROPERTIES]?: number;\n    };\n}\nconst FRESH_GRID_SIZE = 4;\nconst BALHAM_GRID_SIZE = 4;\nconst ALPINE_GRID_SIZE = 6;\n\nconst HARD_CODED_SIZES: HardCodedSize = {\n    'ag-theme-material': {\n        headerHeight: MAT_GRID_SIZE * 7,\n        virtualItemHeight: MAT_GRID_SIZE * 5,\n        rowHeight: MAT_GRID_SIZE * 6,\n        chartMenuPanelWidth: 220\n    },\n    'ag-theme-classic': {\n        headerHeight: 25,\n        virtualItemHeight: FRESH_GRID_SIZE * 5,\n        rowHeight: 25,\n        chartMenuPanelWidth: 220\n    },\n    'ag-theme-balham': {\n        headerHeight: BALHAM_GRID_SIZE * 8,\n        virtualItemHeight: BALHAM_GRID_SIZE * 7,\n        rowHeight: BALHAM_GRID_SIZE * 7,\n        chartMenuPanelWidth: 220\n    },\n    'ag-theme-alpine': {\n        headerHeight: ALPINE_GRID_SIZE * 8,\n        virtualItemHeight: ALPINE_GRID_SIZE * 5,\n        rowHeight: ALPINE_GRID_SIZE * 7,\n        chartMenuPanelWidth: 240\n    }\n};\n\n/**\n * this object contains a list of Sass variables and an array\n * of CSS styles required to get the correct value.\n * eg. $virtual-item-height requires a structure, so we can get its height.\n * <div class=\"ag-theme-balham\">\n *     <div class=\"ag-virtual-list-container\">\n *         <div class=\"ag-virtual-list-item\"></div>\n *     </div>\n */\nconst SASS_PROPERTY_BUILDER: { [key in SASS_PROPERTIES]: string[] } = {\n    headerHeight: ['ag-header-row'],\n    virtualItemHeight: ['ag-virtual-list-container', 'ag-virtual-list-item'],\n    rowHeight: ['ag-row'],\n    chartMenuPanelWidth: ['ag-chart-docked-container']\n};\n\nconst CALCULATED_SIZES: HardCodedSize = {};\n\n@Bean('environment')\nexport class Environment {\n    @Autowired('eGridDiv') private eGridDiv: HTMLElement;\n\n    public getSassVariable(theme: string, key: SASS_PROPERTIES): number {\n        const useTheme = 'ag-theme-' + (theme.match('material') ? 'material' : theme.match('balham') ? 'balham' : theme.match('alpine') ? 'alpine' : 'classic');\n        const defaultValue = HARD_CODED_SIZES[useTheme][key];\n        let calculatedValue = 0;\n\n        if (!CALCULATED_SIZES[theme]) {\n            CALCULATED_SIZES[theme] = {};\n        }\n\n        if (CALCULATED_SIZES[theme][key]) {\n            return CALCULATED_SIZES[theme][key];\n        }\n\n        if (SASS_PROPERTY_BUILDER[key]) {\n            const classList = SASS_PROPERTY_BUILDER[key];\n            const div = document.createElement('div');\n            const el: HTMLDivElement = classList.reduce((el: HTMLDivElement, currentClass: string, idx: number) => {\n                if (idx === 0) {\n                    _.addCssClass(el, theme);\n                }\n\n                const div = document.createElement('div');\n                _.addCssClass(div, currentClass);\n                el.appendChild(div);\n\n                return div;\n            }, div);\n\n            if (document.body) {\n                document.body.appendChild(div);\n                calculatedValue = parseInt(window.getComputedStyle(el).height, 10);\n                document.body.removeChild(div);\n            }\n        }\n\n        CALCULATED_SIZES[theme][key] = calculatedValue || defaultValue;\n\n        return CALCULATED_SIZES[theme][key];\n    }\n\n    public isThemeDark(): boolean {\n        const { theme } = this.getTheme();\n        return !!theme && theme.indexOf('dark') >= 0;\n    }\n\n    public useNativeCheckboxes() {\n        const { theme } = this.getTheme();\n        return !!theme && theme.indexOf('alpine') >= 0;\n    }\n\n    public chartMenuPanelWidth() {\n        return HARD_CODED_SIZES[this.getTheme().themeFamily].chartMenuPanelWidth;\n    }\n\n    public getTheme(): { theme?: string, el?: HTMLElement, themeFamily?: string } {\n        const reg = /\\bag-(fresh|dark|blue|material|bootstrap|(?:theme-([\\w\\-]*)))\\b/;\n        let el: HTMLElement = this.eGridDiv;\n        let themeMatch: RegExpMatchArray;\n\n        while (el) {\n            themeMatch = reg.exec(el.className);\n            if (!themeMatch) {\n                el = el.parentElement;\n            } else {\n                break;\n            }\n        }\n\n        if (!themeMatch) { return {}; }\n\n        const theme = themeMatch[0];\n        const usingOldTheme = themeMatch[2] === undefined;\n\n        if (usingOldTheme) {\n            const newTheme = theme.replace('ag-', 'ag-theme-');\n            _.doOnce(() => console.warn(`ag-Grid: As of v19 old theme are no longer provided. Please replace ${theme} with ${newTheme}.`), 'using-old-theme');\n        }\n\n        return { theme, el, themeFamily: theme.replace(/-dark$/, '') };\n    }\n}\n"]}