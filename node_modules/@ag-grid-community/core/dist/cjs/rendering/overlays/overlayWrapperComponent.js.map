{"version":3,"sources":["../../src/ts/rendering/overlays/overlayWrapperComponent.ts"],"names":[],"mappings":"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","file":"overlayWrapperComponent.js","sourcesContent":["import {GridOptionsWrapper} from \"../../gridOptionsWrapper\";\nimport {Autowired, PostConstruct} from \"../../context/context\";\nimport {Component} from \"../../widgets/component\";\nimport {UserComponentFactory} from \"../../components/framework/userComponentFactory\";\nimport {RefSelector} from \"../../widgets/componentAnnotations\";\nimport {ILoadingOverlayComp} from \"./loadingOverlayComponent\";\nimport {_, Promise} from '../../utils';\nimport {INoRowsOverlayComp} from \"./noRowsOverlayComponent\";\n\nenum LoadingType {Loading, NoRows}\n\nexport class OverlayWrapperComponent extends Component {\n\n    // wrapping in outer div, and wrapper, is needed to center the loading icon\n    // The idea for centering came from here: http://www.vanseodesign.com/css/vertical-centering/\n    private static TEMPLATE =\n        `<div class=\"ag-overlay\" aria-hidden=\"true\">\n            <div class=\"ag-overlay-panel\">\n                <div class=\"ag-overlay-wrapper\" ref=\"eOverlayWrapper\"></div>\n            </div>\n        </div>`;\n\n    @Autowired('gridOptionsWrapper') gridOptionsWrapper: GridOptionsWrapper;\n    @Autowired('userComponentFactory') userComponentFactory: UserComponentFactory;\n\n    @RefSelector('eOverlayWrapper') eOverlayWrapper: HTMLElement;\n\n    private activeOverlay: ILoadingOverlayComp;\n    private inProgress = false;\n    private destroyRequested = false;\n\n    constructor() {\n        super(OverlayWrapperComponent.TEMPLATE);\n    }\n\n    @PostConstruct\n    private postConstruct(): void {\n        this.gridOptionsWrapper.addLayoutElement(this.eOverlayWrapper);\n        this.setDisplayed(false);\n    }\n\n    private setWrapperTypeClass(loadingType: LoadingType): void {\n        _.addOrRemoveCssClass(this.eOverlayWrapper, 'ag-overlay-loading-wrapper', loadingType === LoadingType.Loading);\n        _.addOrRemoveCssClass(this.eOverlayWrapper, 'ag-overlay-no-rows-wrapper', loadingType === LoadingType.NoRows);\n    }\n\n    public showLoadingOverlay(): void {\n        const workItem: Promise<ILoadingOverlayComp> = this.userComponentFactory.newLoadingOverlayComponent({\n            api: this.gridOptionsWrapper.getApi()\n        });\n        this.showOverlay<ILoadingOverlayComp>(workItem);\n    }\n\n    public showNoRowsOverlay(): void {\n        const workItem: Promise<INoRowsOverlayComp> = this.userComponentFactory.newNoRowsOverlayComponent({\n            api: this.gridOptionsWrapper.getApi()\n        });\n        this.showOverlay<INoRowsOverlayComp>(workItem);\n    }\n\n    private showOverlay<T>(workItem: Promise<T>) {\n        if (this.inProgress) {\n            return;\n        }\n        this.setWrapperTypeClass(LoadingType.NoRows);\n        this.destroyActiveOverlay();\n\n        this.inProgress = true;\n\n        workItem.then(comp => {\n            this.inProgress = false;\n\n            this.eOverlayWrapper.appendChild(comp.getGui());\n            this.activeOverlay = comp;\n\n            if (this.destroyRequested) {\n                this.destroyRequested = false;\n                this.destroyActiveOverlay();\n            }\n        });\n\n        this.setDisplayed(true);\n    }\n\n    private destroyActiveOverlay(): void {\n        if (this.inProgress) {\n            this.destroyRequested = true;\n            return;\n        }\n\n        if (!this.activeOverlay) {\n            return;\n        }\n\n        if (this.activeOverlay.destroy) {\n            this.activeOverlay.destroy();\n        }\n\n        this.activeOverlay = undefined;\n        _.clearElement(this.eOverlayWrapper);\n    }\n\n    public hideOverlay(): void {\n        this.destroyActiveOverlay();\n        this.setDisplayed(false);\n    }\n\n    public destroy(): void {\n        super.destroy();\n        this.destroyActiveOverlay();\n    }\n}\n"]}