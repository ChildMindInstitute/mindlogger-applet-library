{"version":3,"sources":["../../src/ts/rendering/cellRenderers/animateSlideCellRenderer.ts"],"names":[],"mappings":"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","file":"animateSlideCellRenderer.js","sourcesContent":["\nimport { ICellRenderer } from \"./iCellRenderer\";\nimport { Component } from \"../../widgets/component\";\nimport { _ } from \"../../utils\";\nimport { Autowired } from \"../../context/context\";\nimport { FilterManager } from \"../../filter/filterManager\";\n\nexport class AnimateSlideCellRenderer extends Component implements ICellRenderer {\n\n    private static TEMPLATE =\n        '<span>' +\n        '<span class=\"ag-value-slide-current\"></span>' +\n        '</span>';\n\n    private params: any;\n\n    private eCurrent: HTMLElement;\n    private ePrevious: HTMLElement;\n\n    private lastValue: any;\n\n    private refreshCount = 0;\n\n    @Autowired('filterManager') private filterManager: FilterManager;\n\n    constructor() {\n        super(AnimateSlideCellRenderer.TEMPLATE);\n\n        this.eCurrent = this.queryForHtmlElement('.ag-value-slide-current');\n    }\n\n    public init(params: any): void {\n        this.params = params;\n        this.refresh(params);\n    }\n\n    public addSlideAnimation(): void {\n        this.refreshCount++;\n\n        // below we keep checking this, and stop working on the animation\n        // if it no longer matches - this means another animation has started\n        // and this one is stale.\n        const refreshCountCopy = this.refreshCount;\n\n        // if old animation, remove it\n        if (this.ePrevious) {\n            this.getGui().removeChild(this.ePrevious);\n        }\n\n        this.ePrevious = _.loadTemplate('<span class=\"ag-value-slide-previous ag-value-slide-out\"></span>');\n        this.ePrevious.innerHTML = this.eCurrent.innerHTML;\n        this.getGui().insertBefore(this.ePrevious, this.eCurrent);\n\n        // having timeout of 0 allows use to skip to the next css turn,\n        // so we know the previous css classes have been applied. so the\n        // complex set of setTimeout below creates the animation\n        window.setTimeout(() => {\n            if (refreshCountCopy !== this.refreshCount) { return; }\n            _.addCssClass(this.ePrevious, 'ag-value-slide-out-end');\n        }, 50);\n\n        window.setTimeout(() => {\n            if (refreshCountCopy !== this.refreshCount) { return; }\n            this.getGui().removeChild(this.ePrevious);\n            this.ePrevious = null;\n        }, 3000);\n    }\n\n    public refresh(params: any): boolean {\n\n        let value = params.value;\n\n        if (_.missing(value)) {\n            value = '';\n        }\n\n        if (value === this.lastValue) {\n            return;\n        }\n\n        // we don't show the delta if we are in the middle of a filter. see comment on FilterManager\n        // with regards processingFilterChange\n        if (this.filterManager.isSuppressFlashingCellsBecauseFiltering()) {\n            return;\n        }\n\n        this.addSlideAnimation();\n\n        this.lastValue = value;\n\n        if (_.exists(params.valueFormatted)) {\n            this.eCurrent.innerHTML = params.valueFormatted;\n        } else if (_.exists(params.value)) {\n            this.eCurrent.innerHTML = value;\n        } else {\n            _.clearElement(this.eCurrent);\n        }\n\n        return true;\n    }\n}\n"]}