{"version":3,"sources":["../../source/steps/getTimeToNextUpdate.test.js"],"names":["getTimeToNextUpdate","INFINITY","getStepChangesAt","getTimeToStepChange","describe","it","expect","minTime","format","now","future","isFirstStep","to","equal","Date","nextStep","formatAs","be","undefined","should","test","unit","prevStep"],"mappings":"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","sourcesContent":["import getTimeToNextUpdate, { INFINITY, getStepChangesAt, getTimeToStepChange } from './getTimeToNextUpdate'\r\n\r\ndescribe('getTimeToNextUpdate', () => {\r\n\tit('should return infinity when there are no more steps, and it does not format as a unit (past)', () => {\r\n\t\texpect(getTimeToNextUpdate(-4 * 60 * 1000, {\r\n\t\t\tminTime: 59.5,\r\n\t\t\tformat: () => ''\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tisFirstStep: true\r\n\t\t})).to.equal(INFINITY)\r\n\t})\r\n\r\n\tit('should support date argument', () => {\r\n\t\texpect(getTimeToNextUpdate(new Date(4 * 60 * 1000), {\r\n\t\t\tminTime: 60\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tisFirstStep: true,\r\n\t\t\tnextStep: {}\r\n\t\t})).to.equal(3 * 60 * 1000 + 1)\r\n\t})\r\n\r\n\tit('should return this step\\'s \"minTime\" timestamp (future)', () => {\r\n\t\texpect(getTimeToNextUpdate(4 * 60 * 1000, {\r\n\t\t\tminTime: 60,\r\n\t\t\tformat: () => ''\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tisFirstStep: true,\r\n\t\t\tnextStep: {\r\n\t\t\t\tformat: () => ''\r\n\t\t\t}\r\n\t\t})).to.equal(3 * 60 * 1000 + 1)\r\n\t})\r\n\r\n\tit('should return undefined when there is a next step and time to next update can not be reliably determined (formatAs) (past)', () => {\r\n\t\texpect(getTimeToNextUpdate(-4 * 60 * 1000, {\r\n\t\t\tminTime: 60,\r\n\t\t\tformatAs: 'minute'\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tisFirstStep: true,\r\n\t\t\tnextStep: {\r\n\t\t\t\tformatAs: 'unknown-time-unit'\r\n\t\t\t}\r\n\t\t})).to.be.undefined\r\n\t})\r\n\r\n\tit('should get time to next update (no next step) (past)', () => {\r\n\t\tgetTimeToNextUpdate(-4 * 60 * 1000, {\r\n\t\t\tformatAs: 'minute',\r\n\t\t\tminTime: 59.5\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tisFirstStep: true\r\n\t\t}).should.equal(0.5 * 60 * 1000)\r\n\t})\r\n\r\n\tit('should get time to next update (no next step) (future)', () => {\r\n\t\tgetTimeToNextUpdate(4 * 60 * 1000, {\r\n\t\t\tformatAs: 'minute',\r\n\t\t\tminTime: 59.5\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tisFirstStep: true\r\n\t\t}).should.equal(0.5 * 60 * 1000 + 1)\r\n\t})\r\n\r\n\tit('should get time to next update (has prev/next step without `minTime`) (future)', () => {\r\n\t\tgetTimeToNextUpdate(4 * 60 * 1000, {\r\n\t\t\tformatAs: 'minute',\r\n\t\t\tminTime: 59.5\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tisFirstStep: true,\r\n\t\t\tnextStep: {\r\n\t\t\t\tformatAs: 'hour',\r\n\t\t\t\ttest: () => false\r\n\t\t\t}\r\n\t\t}).should.equal(0.5 * 60 * 1000 + 1)\r\n\t})\r\n\r\n\tit('should get time to next update (has `getTimeToNextUpdate`) (past)', () => {\r\n\t\tgetTimeToNextUpdate(-4 * 60 * 1000, {\r\n\t\t\tformatAs: 'minute',\r\n\t\t\tminTime: 59.5,\r\n\t\t\tgetTimeToNextUpdate: () => 0.25 * 60 * 1000\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tisFirstStep: true\r\n\t\t}).should.equal(0.25 * 60 * 1000)\r\n\t})\r\n\r\n\tit('should get time to next update (has `getTimeToNextUpdate`) (future)', () => {\r\n\t\tgetTimeToNextUpdate(4 * 60 * 1000, {\r\n\t\t\tformatAs: 'minute',\r\n\t\t\tminTime: 59.5,\r\n\t\t\tgetTimeToNextUpdate: () => 0.25 * 60 * 1000\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tisFirstStep: true\r\n\t\t}).should.equal(0.25 * 60 * 1000)\r\n\t})\r\n\r\n\tit('should get time to next update (has both unit and prev/next steps with `minTime`) (returns time to \"minTime\" of next step) (past)', () => {\r\n\t\tgetTimeToNextUpdate(-59 * 60 * 1000, {\r\n\t\t\tformatAs: 'minute',\r\n\t\t\tminTime: 59.5\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tisFirstStep: true,\r\n\t\t\tnextStep: {\r\n\t\t\t\tformatAs: 'hour',\r\n\t\t\t\tminTime: 59.5 * 60\r\n\t\t\t}\r\n\t\t}).should.equal(0.5 * 60 * 1000)\r\n\t})\r\n\r\n\tit('should get time to next update (has no unit but has prev/next step with `minTime`) (returns time to \"minTime\" of next step) (past)', () => {\r\n\t\tgetTimeToNextUpdate(-59 * 60 * 1000, {\r\n\t\t\tformat: () => {},\r\n\t\t\tminTime: 59.5\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tisFirstStep: true,\r\n\t\t\tnextStep: {\r\n\t\t\t\tformatAs: 'hour',\r\n\t\t\t\tminTime: 59.5 * 60\r\n\t\t\t}\r\n\t\t}).should.equal(0.5 * 60 * 1000)\r\n\t})\r\n\r\n\tit('should get time to next update (will be outside of the first step) (future)', () => {\r\n\t\tgetTimeToNextUpdate(60 * 60 * 1000, {\r\n\t\t\tformatAs: 'hour',\r\n\t\t\tminTime: 60 * 60\r\n\t\t}, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tisFirstStep: true\r\n\t\t}).should.equal(1)\r\n\t})\r\n})\r\n\r\ndescribe('getStepChangesAt', () => {\r\n\tit('should work for \"round\" steps', () => {\r\n\t\t// Future.\r\n\t\t// Is at zero point.\r\n\t\t// No next step.\r\n\t\t// No tickable unit.\r\n\t\t// Doesn't update.\r\n\t\tgetStepChangesAt({\r\n\t\t\tunit: 'now'\r\n\t\t}, 0, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tprevStep: undefined\r\n\t\t}).should.equal(INFINITY)\r\n\r\n\t\t// Past.\r\n\t\t// Is at zero point.\r\n\t\t// The next step is seconds.\r\n\t\t// Updates at the next step.\r\n\t\tgetStepChangesAt({\r\n\t\t\tunit: 'second',\r\n\t\t\tminTime: 1\r\n\t\t}, 0, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tprevStep: {}\r\n\t\t}).should.equal(1 * 1000)\r\n\r\n\t\t// Future.\r\n\t\t// Inside the first step.\r\n\t\t// Updates after zero point.\r\n\t\tgetStepChangesAt({\r\n\t\t\tunit: 'now'\r\n\t\t}, 0.9 * 1000, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tprevStep: undefined\r\n\t\t}).should.equal(0.9 * 1000 + 1)\r\n\r\n\t\t// Future.\r\n\t\t// The first step doesn't start at 0.\r\n\t\t// Outside of the first step.\r\n\t\t// Updates right after zero point.\r\n\t\tgetTimeToStepChange(undefined, 0.9 * 1000, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tprevStep: undefined\r\n\t\t}).should.equal(0.9 * 1000 + 1)\r\n\r\n\t\t// Past.\r\n\t\t// The current step is `undefined`.\r\n\t\t// The next step is the first step.\r\n\t\t// The first step doesn't start at 0.\r\n\t\t// Outside of the first step.\r\n\t\t// Updates at entering the first step.\r\n\t\tgetStepChangesAt({\r\n\t\t\tminTime: 1,\r\n\t\t\tunit: 'second'\r\n\t\t}, -0.9 * 1000, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tprevStep: {}\r\n\t\t}).should.equal(0.1 * 1000)\r\n\r\n\t\t// Future.\r\n\t\t// The first step doesn't start at 0.\r\n\t\t// Will output empty string after it exits the current step.\r\n\t\tgetStepChangesAt({\r\n\t\t\tminTime: 1,\r\n\t\t\tunit: 'second'\r\n\t\t}, 1.1 * 1000, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tprevStep: undefined\r\n\t\t}).should.equal(0.1 * 1000 + 1)\r\n\r\n\t\t// Past.\r\n\t\t// Next step is seconds.\r\n\t\t// The \"next\" step doesn't have `minTime`,\r\n\t\t// so \"time to next update\" couldn't be determined.\r\n\t\texpect(getStepChangesAt({\r\n\t\t\tunit: 'unknown-time-unit'\r\n\t\t}, 0, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tprevStep: {}\r\n\t\t})).to.be.undefined\r\n\r\n\t\t// Past.\r\n\t\t// No next step.\r\n\t\t// The last step never changes.\r\n\t\tgetTimeToStepChange(undefined, 0, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tisFirstStep: undefined\r\n\t\t}).should.equal(INFINITY)\r\n\r\n\t\t// Future.\r\n\t\t// Current step is seconds.\r\n\t\t// Updates after zero point.\r\n\t\tgetStepChangesAt({\r\n\t\t\tunit: 'second'\r\n\t\t}, 0, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: true,\r\n\t\t\tprevStep: undefined\r\n\t\t}).should.equal(1)\r\n\r\n\t\t// Past.\r\n\t\t// Next step is minutes.\r\n\t\t// Already at zero point, so no need to update at zero point.\r\n\t\tgetStepChangesAt({\r\n\t\t\tminTime: 60,\r\n\t\t\tformatAs: 'minute'\r\n\t\t}, 0, {\r\n\t\t\tnow: 0,\r\n\t\t\tfuture: false,\r\n\t\t\tprevStep: {}\r\n\t\t}).should.equal(60 * 1000)\r\n\t})\r\n})"],"file":"getTimeToNextUpdate.test.js"}